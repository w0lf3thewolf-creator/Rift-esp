-- Rift Menu ESP - Меньшая иконка глаза
local success, errorMsg = pcall(function()
    if not game:IsLoaded() then
        game.Loaded:Wait()
    end
    
    local Players = game:GetService("Players")
    local CoreGui = game:GetService("CoreGui")
    local TweenService = game:GetService("TweenService")
    
    -- Удаляем старые GUI
    if CoreGui:FindFirstChild("RiftMenuESPSmall") then
        CoreGui.RiftMenuESPSmall:Destroy()
    end
    
    -- Создание GUI
    local RiftMenu = Instance.new("ScreenGui")
    RiftMenu.Name = "RiftMenuESPSmall"
    RiftMenu.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    RiftMenu.ResetOnSpawn = false
    
    -- Главный круглый фрейм (еще меньше)
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Size = UDim2.new(0, 85, 0, 85) -- Уменьшил до 85
    MainFrame.Position = UDim2.new(0.02, 0, 0.25, 0)
    MainFrame.BackgroundColor3 = Color3.fromRGB(8, 8, 8)
    MainFrame.BorderSizePixel = 0
    MainFrame.Active = true
    MainFrame.Draggable = true
    
    -- Круглая форма
    local Corner = Instance.new("UICorner")
    Corner.CornerRadius = UDim.new(1, 0)
    Corner.Parent = MainFrame
    
    -- Тонкая обводка
    local Stroke = Instance.new("UIStroke")
    Stroke.Color = Color3.fromRGB(40, 40, 40)
    Stroke.Thickness = 1
    Stroke.Parent = MainFrame
    
    MainFrame.Parent = RiftMenu
    
    -- Центральная кнопка (меньше)
    local ESPButton = Instance.new("TextButton")
    ESPButton.Name = "ESPButton"
    ESPButton.Size = UDim2.new(0.8, 0, 0.8, 0) -- 80% от фрейма
    ESPButton.Position = UDim2.new(0.1, 0, 0.1, 0)
    ESPButton.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
    ESPButton.BorderSizePixel = 0
    ESPButton.Text = ""
    ESPButton.TextColor3 = Color3.fromRGB(200, 200, 200)
    ESPButton.TextSize = 10
    
    -- Круглая кнопка
    local ButtonCorner = Instance.new("UICorner")
    ButtonCorner.CornerRadius = UDim.new(1, 0)
    ButtonCorner.Parent = ESPButton
    
    local ButtonStroke = Instance.new("UIStroke")
    ButtonStroke.Color = Color3.fromRGB(30, 30, 30)
    ButtonStroke.Thickness = 0.8
    ButtonStroke.Parent = ESPButton
    
    ESPButton.Parent = MainFrame
    
    -- ИКОНКА ГЛАЗА (МЕНЬШЕ)
    local ESPIcon = Instance.new("TextLabel")
    ESPIcon.Name = "ESPIcon"
    ESPIcon.Size = UDim2.new(1, 0, 1, 0)
    ESPIcon.BackgroundTransparency = 1
    ESPIcon.Text = "○" -- Меньший символ круга вместо глаза
    ESPIcon.TextColor3 = Color3.fromRGB(160, 160, 160)
    ESPIcon.TextSize = 16 -- Уменьшил с 20 до 16
    ESPIcon.Font = Enum.Font.Gotham
    ESPIcon.Parent = ESPButton
    
    -- Текст RIFT (меньше)
    local Title = Instance.new("TextLabel")
    Title.Name = "Title"
    Title.Size = UDim2.new(1, 0, 0.25, 0)
    Title.Position = UDim2.new(0, 0, -0.2, 0)
    Title.BackgroundTransparency = 1
    Title.Text = "RIFT"
    Title.TextColor3 = Color3.fromRGB(130, 130, 130)
    Title.TextSize = 10 -- Уменьшил
    Title.Font = Enum.Font.GothamSemibold
    Title.Parent = MainFrame
    
    -- Статус (меньше)
    local StatusLabel = Instance.new("TextLabel")
    StatusLabel.Name = "Status"
    StatusLabel.Size = UDim2.new(1, 0, 0.25, 0)
    StatusLabel.Position = UDim2.new(0, 0, 1, -4)
    StatusLabel.BackgroundTransparency = 1
    StatusLabel.Text = "OFF"
    StatusLabel.TextColor3 = Color3.fromRGB(160, 60, 60)
    StatusLabel.TextSize = 9 -- Уменьшил
    StatusLabel.Font = Enum.Font.Gotham
    StatusLabel.Parent = MainFrame
    
    -- Переменные
    local ESPEnabled = false
    local ESPTable = {}
    local ESPConnections = {}
    
    -- Анимация наведения (минимальная)
    ESPButton.MouseEnter:Connect(function()
        local color = ESPEnabled and Color3.fromRGB(25, 80, 25) or Color3.fromRGB(22, 22, 22)
        local tween = TweenService:Create(ESPButton, TweenInfo.new(0.1), {
            BackgroundColor3 = color
        })
        tween:Play()
    end)
    
    ESPButton.MouseLeave:Connect(function()
        local color = ESPEnabled and Color3.fromRGB(20, 70, 20) or Color3.fromRGB(15, 15, 15)
        local tween = TweenService:Create(ESPButton, TweenInfo.new(0.1), {
            BackgroundColor3 = color
        })
        tween:Play()
    end)
    
    -- Функция ESP
    local function CreateESP(player)
        if not player or player == Players.LocalPlayer or not player.Character then 
            return 
        end
        
        local char = player.Character
        local hrp = char:WaitForChild("HumanoidRootPart", 1)
        if not hrp then return end
        
        -- Подсветка
        local highlight = Instance.new("Highlight")
        highlight.Name = player.Name .. "_RiftESP"
        highlight.FillColor = Color3.fromRGB(0, 100, 230)
        highlight.FillTransparency = 0.4
        highlight.OutlineColor = Color3.fromRGB(180, 200, 255)
        highlight.OutlineTransparency = 0
        highlight.DepthMode = Enum.HighlightDepthMode.AlwaysOnTop
        highlight.Parent = char
        
        -- Имя игрока (компактное)
        local billboard = Instance.new("BillboardGui")
        billboard.Name = "RiftESPName"
        billboard.Size = UDim2.new(0, 90, 0, 20)
        billboard.StudsOffset = Vector3.new(0, 2.5, 0)
        billboard.AlwaysOnTop = true
        billboard.Adornee = hrp
        billboard.MaxDistance = 200
        billboard.Parent = char
        
        local nameLabel = Instance.new("TextLabel")
        nameLabel.Size = UDim2.new(1, 0, 1, 0)
        nameLabel.BackgroundTransparency = 1
        nameLabel.Text = player.Name
        nameLabel.TextColor3 = Color3.fromRGB(160, 180, 240)
        nameLabel.TextSize = 10 -- Меньший текст
        nameLabel.Font = Enum.Font.Gotham
        nameLabel.TextStrokeTransparency = 0.6
        nameLabel.Parent = billboard
        
        ESPTable[player] = {Highlight = highlight, Billboard = billboard}
        
        -- Обновление при смене персонажа
        local conn = player.CharacterAdded:Connect(function()
            task.wait(0.3)
            if ESPTable[player] then
                pcall(function()
                    ESPTable[player].Highlight:Destroy()
                    ESPTable[player].Billboard:Destroy()
                end)
            end
            task.wait(0.3)
            CreateESP(player)
        end)
        
        table.insert(ESPConnections, conn)
    end
    
    local function RemoveESP(player)
        if ESPTable[player] then
            pcall(function()
                ESPTable[player].Highlight:Destroy()
                ESPTable[player].Billboard:Destroy()
            end)
            ESPTable[player] = nil
        end
    end
    
    -- Переключение ESP
    local function ToggleESP()
        ESPEnabled = not ESPEnabled
        
        if ESPEnabled then
            -- ВКЛЮЧЕНИЕ
            ESPButton.BackgroundColor3 = Color3.fromRGB(20, 85, 20)
            ESPIcon.TextColor3 = Color3.fromRGB(150, 240, 150)
            StatusLabel.Text = "ON"
            StatusLabel.TextColor3 = Color3.fromRGB(60, 200, 60)
            
            -- ESP для текущих игроков
            for _, player in ipairs(Players:GetPlayers()) do
                task.spawn(CreateESP, player)
            end
            
            -- Новые игроки
            local addConn = Players.PlayerAdded:Connect(function(player)
                task.wait(0.5)
                CreateESP(player)
            end)
            
            -- Выход игроков
            local remConn = Players.PlayerRemoving:Connect(RemoveESP)
            
            table.insert(ESPConnections, addConn)
            table.insert(ESPConnections, remConn)
            
        else
            -- ВЫКЛЮЧЕНИЕ
            ESPButton.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
            ESPIcon.TextColor3 = Color3.fromRGB(160, 160, 160)
            StatusLabel.Text = "OFF"
            StatusLabel.TextColor3 = Color3.fromRGB(160, 60, 60)
            
            -- Удаляем ESP
            for player, _ in pairs(ESPTable) do
                RemoveESP(player)
            end
            
            ESPTable = {}
            
            -- Очищаем соединения
            for _, conn in ipairs(ESPConnections) do
                pcall(function() conn:Disconnect() end)
            end
            ESPConnections = {}
        end
    end
    
    -- Клик по кнопке
    ESPButton.MouseButton1Click:Connect(ToggleESP)
    
    -- Добавляем в интерфейс
    RiftMenu.Parent = CoreGui
    
    -- Информация
    print("┌─────────────────┐")
    print("│ RIFT MENU ESP   │")
    print("│ Size: 85x85     │")
    print("│ Minimal design  │")
    print("└─────────────────┘")
    
end)

if not success then
    warn("Rift Menu ESP Error:", errorMsg)
end
